import{_ as L,h as U,v as h,l as B,u as q,c as E,a as l,w as s,r as n,b as p,d as H,e as N,f as I,g as P,E as V,o as _,i as k,j as f,k as T}from"./index-BAzr2iUZ.js";const j={name:"LoginPage",components:{User:q,Lock:B,View:h,Hide:U},setup(){const c=I(),e=N(),b=P(),o=p(null),i=p(!1),w=p(!1),d=H({username:"",password:"",remember:!1});return{loginForm:d,loginRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度不能小于3位",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}]},loginFormRef:o,loading:i,passwordVisible:w,handleLogin:()=>{o.value.validate(async g=>{if(g){i.value=!0;try{console.log("开始登录..."),await c.dispatch("user/login",d),console.log("登录成功，获取用户信息..."),await c.dispatch("user/getInfo"),console.log("用户信息获取成功，准备跳转...");const t=b.query.redirect||"/dashboard";console.log("跳转目标:",t),V.success("登录成功"),setTimeout(()=>{e.push(t)},500)}catch(t){console.error("登录失败:",t),V.error(t.message||"登录失败")}finally{i.value=!1}}})},toRegister:()=>{e.push("/register")}}}},G={class:"login-container"};function M(c,e,b,o,i,w){const d=n("User"),m=n("el-icon"),u=n("el-input"),a=n("el-form-item"),g=n("Lock"),t=n("View"),y=n("Hide"),x=n("el-checkbox"),v=n("el-link"),F=n("el-button"),R=n("el-form"),C=n("el-card");return _(),E("div",G,[l(C,{class:"login-card"},{header:s(()=>e[4]||(e[4]=[T("h3",{class:"login-title"},"GPU服务器监控系统",-1)])),default:s(()=>[l(R,{ref:"loginFormRef",model:o.loginForm,rules:o.loginRules,class:"login-form",autocomplete:"on","label-position":"left"},{default:s(()=>[l(a,{prop:"username"},{default:s(()=>[l(u,{modelValue:o.loginForm.username,"onUpdate:modelValue":e[0]||(e[0]=r=>o.loginForm.username=r),placeholder:"用户名",type:"text",autocomplete:"on"},{prefix:s(()=>[l(m,null,{default:s(()=>[l(d)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(a,{prop:"password"},{default:s(()=>[l(u,{modelValue:o.loginForm.password,"onUpdate:modelValue":e[2]||(e[2]=r=>o.loginForm.password=r),placeholder:"密码",type:o.passwordVisible?"text":"password",autocomplete:"on"},{prefix:s(()=>[l(m,null,{default:s(()=>[l(g)]),_:1})]),suffix:s(()=>[l(m,{class:"cursor-pointer",onClick:e[1]||(e[1]=r=>o.passwordVisible=!o.passwordVisible)},{default:s(()=>[o.passwordVisible?(_(),k(t,{key:0})):(_(),k(y,{key:1}))]),_:1})]),_:1},8,["modelValue","type"])]),_:1}),l(a,null,{default:s(()=>[l(x,{modelValue:o.loginForm.remember,"onUpdate:modelValue":e[3]||(e[3]=r=>o.loginForm.remember=r)},{default:s(()=>e[5]||(e[5]=[f("记住我")])),_:1},8,["modelValue"]),l(v,{type:"primary",class:"float-right",onClick:o.toRegister},{default:s(()=>e[6]||(e[6]=[f("注册账号")])),_:1},8,["onClick"])]),_:1}),l(a,null,{default:s(()=>[l(F,{loading:o.loading,type:"primary",style:{width:"100%"},onClick:o.handleLogin},{default:s(()=>e[7]||(e[7]=[f(" 登录 ")])),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}const z=L(j,[["render",M],["__scopeId","data-v-33097b24"]]);export{z as default};
